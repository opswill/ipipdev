<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>What is my IP address? — {{ string.upper(Host) }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="What is my IP address? — Yet another tool to find your own IP address and glean information about it." />
  <link rel="canonical" href="https://{{ Host }}/" />

  <!-- CSS -->
  <link rel="stylesheet" href="https://unpkg.com/purecss/build/pure-min.css" />
  <link rel="stylesheet" href="https://unpkg.com/purecss/build/grids-responsive-min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"  />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/open-sans/index.min.css" />

  <!-- JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  {( script.html )}
  {( styles.html )}
</head>

<body>
  <div class="content">
    <div class="pure-g gutters center">
      <div class="pure-u-1 pure-u-md-2-3">
        <div class="l-box">

          <h1>Find Your IP Address</h1>
          <p><code class="ip">{{ IP }}</code></p>
          <p>Yet another tool to find your own IP address and glean information about it.</p>

          <h2>IP Address Details & Intelligence</h2>
          <table class="info-table">

            <tr id="showIPv4" hidden>
              <th scope="row">IPv4 address</th>
              <td id="showIPv4Value">-</td>
            </tr>
            <tr id="showIPv6" hidden>
              <th scope="row">IPv6 address</th>
              <td id="showIPv6Value">-</td>
            </tr>

            {% for _, v in ipairs(context) do %}
              {% if v.Show and v.Value and v.Value ~= "" then %}
                <tr>
                  <th scope="row">{* v.Show *}</th>
                  <td>{* v.Value *}</td>
                </tr>
              {% end %}
            {% end %}

          </table>

          {% if Latitude and Longitude then %}
          <h2>Approximate Location on Map</h2>
          <div id="map"></div>
          {% end %}

          <h2>How to Access IP Data via API?</h2>
          <p>Build your query with the widget below and see the result.</p>

          <div class="input-buttons">
            <button name="ip" class="pure-button widget-select selected" onclick="changeInput('ip', this)">ip</button>

            {% 
            local added = {ip = true}
            for key, value in pairs(ipinfo or {}) do
              if not added[key] and key ~= "source" 
                 and value ~= nil and value ~= "" and type(value) ~= "table" then
                added[key] = true 
         %}
            <button name="{{key}}" class="pure-button widget-select" onclick="changeInput('{{key}}', this)">{{key}}</button>
         {% end end %}

         {% if not added.json then %}
            <button name="json" class="pure-button widget-select" onclick="changeInput('json', this)">json</button>
         {% end %}
          </div>

          <div class="widgetbox input"><code id="command">$ curl {{ Host }}/</code></div>
          <div id="output" class="widgetbox output"></div>

          <form class="pure-form input-buttons" onsubmit="handleSubmit(event)">
            <fieldset>
              <label>
                Check another IP or domain (optional)
                <input id="ipInput" type="text" placeholder="Lookup another IP, domain or hostname"
                  onkeyup="updateIP(this.value.trim())" autocomplete="off" />
              </label>
              <button type="submit" class="pure-button pure-button-primary">Query</button>
            </fieldset>
          </form>
          
          <h2>MCP Tool Server</h2>
            <p class="section-desc">
              Instant IP geolocation and raw WHOIS lookup directly inside any MCP-compatible editor or AI assistant.
            </p>

            <h3>MCP endpoint</h3>
              <div class="widgetbox endpoint">
                <code>https://{{ Host }}/mcp</code>
              </div>

            <h3>Available tools</h3>
              <div class="tools-grid">
                <div class="tool-item">
                  <code class="tool-name">ip_lookup</code>
                    <p>IP or domain geolocation lookup (domains automatically resolved to IPv4).<br>
                      Returns country, region, city, ASN, ISP and all other fields displayed above.<br>
                      <em>Leave the parameter empty to query your current IP.</em></p>
                </div>
                <div class="tool-item">
                  <code class="tool-name">whois_lookup</code>
                    <p>Raw WHOIS query for domains, IPs, CIDR blocks, or ASNs.<br>
                      Returns the complete original record as provided by the registrar or RIR.</p>
                      <em>Leave the parameter empty to query WHOIS of your current IP.</em></p>
                </div>
              </div>

            <h3>Usage</h3>
              <ul class="usage-list">
                <li>Only <strong>Streamable HTTP</strong> transport is supported (used by almost all MCP clients).</li>
                <li>Add the URL above as a remote MCP server in any compatible editor.</li>
                <li>Call tools via <code>@ip_lookup</code> / <code>@whois_lookup</code> or just describe what you need in natural language.</li>
              </ul>

              <div class="tip-box">
                <strong>Try these examples:</strong><br>
                <ul>
                  <li>"Find the geolocation of my current IP."</li>
                  <li>"Get the WHOIS information for this domain: {{ Host }}"</li>
                  <li>"Where is IP 1.1.1.1 located?"</li>
                  <li>"WHOIS for AS13335"</li>
                </ul>
              </div>

        </div>
      </div>
    </div>
  </div>

  <div class="footer">
    <p>©2020-{{string.sub(ngx.today(),0,4)}} - <a href="//{{ngx.var.server_name}}">{{string.upper(ngx.var.server_name)}}</a> - <a href="https://github.com/opswill/ipipdev"> Source Code </a></p>
    <p style="font-size: 0.8em; color: #666; margin-top: 1em; padding: 0 1em;">
      This product includes GeoLite2 data created by MaxMind, available from <a href="https://www.maxmind.com" style="color: #007cba;">maxmind.com</a>.<br>
      Proxy detection powered by IP2Location LITE database, available from <a href="https://lite.ip2location.com" style="color: #007cba;">lite.ip2location.com</a>.
    </p>
  </div>

</body>
</html>
